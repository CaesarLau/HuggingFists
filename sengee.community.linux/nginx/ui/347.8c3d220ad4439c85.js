"use strict";(self.webpackChunksengee_ui=self.webpackChunksengee_ui||[]).push([[347],{84347:(Pt,O,o)=>{o.r(O),o.d(O,{MainModule:()=>ut});var u=o(77152),G=o(82886),t=o(5e3),F=o(13287),Z=o(76083),A=o(57781),g=o(46055),J=o(16817),f=o(50489),T=o(49727),h=o(89445),_=o(24091),z=o(41123),C=o(63640),I=o(65882),L=o(62545),D=o(5156),N=o(404),v=o(72394),V=o(55535),P=o(69808),d=o(11047),m=o(93075),Q=o(80135),b=o(41894),H=o(15052),j=o(16114),y=o(78054);const w=["processGroup"];function E(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"i",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().createFlow()}),t.ALo(1,"nzI18n"),t.qZA()}2&i&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function S(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().importGraph()}),t.ALo(1,"nzI18n"),t.qZA()}2&i&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.import"))}function B(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().batchExportGraph()}),t.ALo(1,"nzI18n"),t.qZA()}if(2&i){t.oxw();const e=t.MAs(14);t.Q6J("disabled",!e.indeterminate&&!e.checked)("nz-tooltip",t.lcZ(1,2,"base.export"))}}function R(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",20),t.NdJ("mouseenter",function(){return t.CHM(e),t.oxw().$implicit.editingVisible=!0})("mouseleave",function(){return t.CHM(e),t.oxw().$implicit.editingVisible=!1}),t._uU(1),t.TgZ(2,"i",21),t.NdJ("click",function(s){t.CHM(e);const a=t.oxw().$implicit;return t.oxw().startEditName(s,a)}),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.alias," "),t.xp6(1),t.Q6J("fontsize",22)("opacity",e.editingVisible?1:.5)("nz-tooltip","\u4fee\u6539\u540d\u79f0")}}function Y(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"input",22),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().$implicit.alias=s})("click",function(s){return s.stopPropagation()})("keyup.enter",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw().saveGraphName(s)})("blur",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw().saveGraphName(s)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.alias)}}function $(i,r){if(1&i&&(t.YNc(0,R,3,4,"div",18),t.YNc(1,Y,1,1,"ng-template",null,19,t.W1O)),2&i){const e=r.$implicit,n=t.MAs(2);t.Q6J("ngIf",!e.editing)("ngIfElse",n)}}function U(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"app-group-tree",23),t.NdJ("selectedGroup",function(s){return t.CHM(e),t.oxw().selectedTargetGroupHandler(s)}),t.ALo(1,"nzI18n"),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("name",t.lcZ(1,3,"base.processGroup"))("groupType",e.groupType)("readonly",!0)}}function k(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p",27)(2,"span",28),t._uU(3,"\u6d41\u7a0b\u540d\u79f0\uff1a"),t.qZA(),t.TgZ(4,"input",29),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(2).formParams.alias=s}),t.qZA()(),t.TgZ(5,"p",30)(6,"span",28),t._uU(7,"\u63cf\u8ff0\u4fe1\u606f\uff1a"),t.qZA(),t.TgZ(8,"textarea",31),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(2).formParams.jsonProperties=s}),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",e.formParams.alias),t.xp6(2),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",e.formParams.jsonProperties)}}function W(i,r){if(1&i&&(t.TgZ(0,"span",34)(1,"nz-upload",35)(2,"p"),t._uU(3,"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20"),t.qZA()()()),2&i){const e=t.oxw(3);t.Q6J("nzSpan",19),t.xp6(1),t.Q6J("nzBeforeUpload",e.beforeUpload)}}function X(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"span",36),t._uU(1),t.TgZ(2,"i",37),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).removeProgramFile()}),t.qZA()()}if(2&i){const e=t.oxw(3);t.Q6J("nzSpan",19),t.xp6(1),t.hij(" ",e.programFile.name," ")}}function K(i,r){if(1&i&&(t.TgZ(0,"p",30)(1,"span",28),t._uU(2,"\u7a0b\u5e8f\u5305\uff1a"),t.qZA(),t.YNc(3,W,4,2,"span",32),t.YNc(4,X,3,2,"ng-template",null,33,t.W1O),t.qZA()),2&i){const e=t.MAs(5),n=t.oxw(2);t.xp6(1),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("ngIf",!n.programFile)("ngIfElse",e)}}function q(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"div",24),t.YNc(2,k,9,6,"ng-container",25),t.YNc(3,K,6,3,"ng-template",null,26,t.W1O),t.qZA(),t.BQk()),2&i){const e=t.MAs(4),n=t.oxw();t.xp6(2),t.Q6J("ngIf","GRAPH"===n.formParams.processType||"JOB"===n.formParams.processType)("ngIfElse",e)}}function tt(i,r){if(1&i&&(t.TgZ(0,"span",42)(1,"nz-upload",35)(2,"p"),t._uU(3,"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20"),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("nzBeforeUpload",e.beforeImport)}}function et(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"span",43),t._uU(1),t.TgZ(2,"i",37),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).removeImportFile()}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.importFile.name," ")}}function nt(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",38)(2,"p"),t.YNc(3,tt,4,1,"span",39),t.YNc(4,et,3,1,"ng-template",null,40,t.W1O),t.qZA(),t.TgZ(6,"p")(7,"label",41),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().overwrite=s}),t._uU(8,"\u662f\u5426\u66f4\u65b0\u540c\u540d\u6d41\u7a0b"),t.qZA()()(),t.BQk()}if(2&i){const e=t.MAs(5),n=t.oxw();t.xp6(3),t.Q6J("ngIf",!n.importFile)("ngIfElse",e),t.xp6(4),t.Q6J("ngModel",n.overwrite)}}function ot(i,r){if(1&i&&t._UZ(0,"nz-option",46),2&i){const e=r.$implicit;t.Q6J("nzLabel",e.version+"("+e.versionTypeZh+")")("nzValue",e.id)}}function it(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",38)(2,"nz-select",44),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().selectedMementoId=s}),t.YNc(3,ot,1,2,"nz-option",45),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngModel",e.selectedMementoId),t.xp6(1),t.Q6J("ngForOf",e.mementoList)}}let st=(()=>{class i{constructor(e,n,s,a,p,c,ft,Ct){this.api=e,this.operatorApi=n,this.router=s,this.message=a,this.i18n=p,this.ser=c,this.service=ft,this.modal=Ct,this.groupType=g.b0.PrcGrp,this.typeData=[{id:"PROGRAM",alias:"\u7a0b\u5e8f\u6d41\u7a0b"},{id:"JOB",alias:"\u4f5c\u4e1a\u63a7\u5236\u6d41\u7a0b"}],this.processTypeData=[{id:"GRAPH",alias:"\u6267\u884c\u56fe\u6d41\u7a0b"},...this.typeData],this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"name",render:"nameColumn"},{i18n:"process.type",field:"graphTypeZh",filterMultiple:!0,listOfFilter:[],filterFn:(l,M)=>l.some(x=>-1!==M.graphType.indexOf(x))},{i18n:"process.computionFramework",field:"computionFrameworkZh",filterMultiple:!0,listOfFilter:[],filterFn:(l,M)=>l.some(x=>-1!==M.computionFramework.indexOf(x))},{i18n:"process.versionNum",field:"currentMementoVersion"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{buttons:[{icon:"sheji1",tip:"menu.design",click:l=>this.editGraph(l)},{icon:"move",tip:"base.move",click:l=>this.moveGraph(l)},{icon:"fuzhi",tip:"base.copy",click:l=>this.copyGraph(l)},{icon:"daochu",tip:"base.export",click:l=>this.getMementoList(l)},{icon:"lishibanben",tip:"process.historicalVersion",click:l=>this.goToMemento(l)},{icon:"job",tip:"menu.job",click:l=>this.goToJob(l)},{icon:"shanchu",tip:"base.delete",type:"delete",confirmTip:"menu.process",click:l=>this.deleteConfirm(l)}]}],this.isVisible=!1,this.formParams={alias:"",processType:"GRAPH",graphType:"",computionFramework:"",_processType:"GRAPH",_graphType:"",_computionFramework:"",jsonProperties:""},this.beforeUpload=l=>"application/zip"!==l.type&&"application/x-zip-compressed"!==l.type?(this.message.error("\u53ea\u80fd\u4e0a\u4f20zip\u5305!"),!1):(this.programFile=l,!1),this.importVisible=!1,this.overwrite=!0,this.exportVisible=!1,this.beforeImport=l=>l.name&&-1!==l.name.indexOf(".flow")?(this.importFile=l,!1):(this.message.error("\u53ea\u80fd\u4e0a\u4f20\u5bfc\u51fa\u7684\u6d41\u7a0b\u5305!"),!1)}ngOnInit(){this.service.getProcessTypeList().subscribe(e=>{this.graphTypeData=e,this.formParams.graphType=this.formParams._graphType=e[0].id,this.mappingGraphTypeAndComputionFramework(),this.columns[3].listOfFilter=[...e,...this.typeData].map(n=>({text:n.alias,value:n.id}))}),this.service.getComputionFrameworkList().subscribe(e=>{this.computionFrameworkData=e,this.formParams.computionFramework=this.formParams._computionFramework=e[0].name,this.mappingGraphTypeAndComputionFramework(),this.columns[4].listOfFilter=e.map(n=>({text:n.alias,value:n.name}))})}selectedGroupHandler(e){this.selectedGroup=e,this.getGraphList()}getGraphList(e=!1){this.selectedGroup?this.api.getGraphList(this.selectedGroup.id,"").subscribe(n=>{this.listOfData=n,this.listOfData.map(s=>{var a;s.versionTypeZh=null===(a=g.IA.find(p=>p.value===s.currentMementoVersionType))||void 0===a?void 0:a.label}),this.mappingGraphTypeAndComputionFramework(),e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.listOfData=null}ngAfterViewInit(){}deleteConfirm(e){this.api.deleteGraph(e.id).subscribe(n=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.getGraphList()})}mappingGraphTypeAndComputionFramework(){!this.listOfData||!this.listOfData.length||(this.graphTypeData&&this.listOfData.map(e=>{var n;e.graphTypeZh="PROGRAM"!==e.graphType?null===(n=this.graphTypeData.find(s=>s.id===e.graphType))||void 0===n?void 0:n.alias:"\u7a0b\u5e8f\u6d41\u7a0b"}),this.computionFrameworkData&&this.listOfData.map(e=>{var n;e.computionFrameworkZh=null===(n=this.computionFrameworkData.find(s=>s.name===e.computionFramework))||void 0===n?void 0:n.alias}))}removeProgramFile(){this.programFile=null}createFlow(){this.formParams.alias=`\u9ed8\u8ba4\u540d\u79f0_${(new Date).getHours()}${(new Date).getMinutes()}${(new Date).getSeconds()}`,this.isVisible=!0}handleOk(){"PROGRAM"===this.formParams.processType?this.addProgramGraph():this.addGraph()}handleCancel(){this.formParams.name=this.formParams.alias=this.formParams.jsonProperties="",this.formParams.processType=this.formParams._processType,this.formParams.graphType=this.formParams._graphType,this.formParams.computionFramework=this.formParams._computionFramework,this.programFile=null,this.isVisible=!1}addProgramGraph(){this.api.createProgram(this.programFile,this.selectedGroup.id).subscribe(e=>{this.handleCancel(),setTimeout(()=>{this.editGraph(e.body)})})}addGraph(){this.formParams.alias?(this.formParams.groupId=this.selectedGroup.id,"JOB"===this.formParams.processType&&(this.formParams.computionFramework="oyez",this.formParams.graphType="JOBCTRL"),this.operatorApi.getContainerOperator(this.formParams.computionFramework,this.formParams.graphType).subscribe(e=>{let n,s;try{n=JSON.parse(e.inputPorts)}catch(c){n=e.inputPorts}try{s=JSON.parse(e.outputPorts)}catch(c){s=e.outputPorts}const a=(new J.j).initWithJsonData(Object.assign(Object.assign({},e),{inport:n,outport:s})),p=(0,A.d9)(this.formParams);delete p.processType,delete p._processType,delete p._graphType,delete p._computionFramework,p.graphXml=a.graphXml,this.api.addGraph(p,this.selectedGroup.id).subscribe(c=>{this.handleCancel(),setTimeout(()=>{this.editGraph(c)})})})):this.message.warning(`${this.i18n.translate("base.pleaseInput")}${this.i18n.translate("base.name").toLocaleLowerCase()}`)}editGraph(e){this.router.navigate(["PROGRAM"===e.graphType?`/process/program/edit/${e.id}`:`/process/edit/${e.id}`])}moveGraph(e){this.ser.show({title:"\u9009\u62e9\u5206\u7ec4",content:this.processGroup,backdropClass:"opacity-mask",top:69,right:225,confirm:()=>new Promise((n,s)=>{this.api.moveGraph(e.id,this.selectedTargetGrp.id).subscribe(a=>{this.message.success("\u79fb\u52a8\u6210\u529f!"),n(!0),this.getGraphList()},a=>{s(!1)})})})}copyGraph(e){this.ser.show({title:"\u9009\u62e9\u5206\u7ec4\u7c98\u8d34",content:this.processGroup,backdropClass:"opacity-mask",top:69,right:225,confirm:()=>new Promise((n,s)=>{this.api.copyGraph(e.id,this.selectedTargetGrp.id).subscribe(a=>{this.message.success("\u7c98\u8d34\u6210\u529f!"),n(!0),this.getGraphList()},a=>{s(!1)})})})}selectedTargetGroupHandler(e){this.selectedTargetGrp=e}importGraph(){this.importVisible=!0}importCancel(){this.importVisible=!1}importOk(){this.api.importGraph(this.importFile,this.selectedGroup.id,this.overwrite).subscribe(e=>{this.message.success("\u5bfc\u5165\u6210\u529f!"),this.importVisible=!1,this.getGraphList()})}removeImportFile(){this.importFile=null}getMementoList(e){this.api.getMementoList(e.id,"").subscribe(n=>{this.mementoList=n,this.mementoList.map(s=>{var a;s.versionTypeZh=null===(a=g.IA.find(p=>p.value===s.versionType))||void 0===a?void 0:a.label}),this.selectedMementoId=this.mementoList[0].id,this.exportVisible=!0})}exportOk(){this.exportVisible=!1,window.open(this.api.exportGraphByMementoId(this.selectedMementoId))}exportCancel(){this.exportVisible=!1}batchExportGraph(){window.open(this.api.exportGraph(this.listOfData.filter(e=>e.selected).map(e=>e.id)))}goToJob(e){this.router.navigate(["process/job/list"],{queryParams:{processId:e.id}})}goToMemento(e){this.router.navigate(["process/memento/list"],{queryParams:{processId:e.id}})}startEditName(e,n){e.stopPropagation(),n.editing=!0,this.editItem=n,this.editItem._alias=n.alias}saveGraphName(e){if(e.alias)return e.alias===e._alias?(delete e._alias,e.editing=!1,e.editingVisible=!1,void(this.editItem=null)):(clearTimeout(this.saveGraphNameTimer),void(this.saveGraphNameTimer=setTimeout(()=>{this.api.renameGraph(e.id,e.alias).subscribe(n=>{e.editing=!1,e.editingVisible=!1,this.editItem=null,this.message.success(`${this.i18n.translate("base.update")}${this.i18n.translate("base.success")}`)})},100)));this.message.warning(`${this.i18n.translate("base.pleaseInput")}${this.i18n.translate("base.name")}`)}documentClickHandler(e){this.editItem&&this.saveGraphName(this.editItem)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.DQ),t.Y36(f.gl),t.Y36(u.F0),t.Y36(T.dD),t.Y36(h.wi),t.Y36(_.qO),t.Y36(z.q),t.Y36(C.Sf))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-process-group"]],viewQuery:function(e,n){if(1&e&&t.Gf(w,5),2&e){let s;t.iGM(s=t.CRH())&&(n.processGroup=s.first)}},hostBindings:function(e,n){1&e&&t.NdJ("click",function(a){return n.documentClickHandler(a)},!1,t.evT)},decls:27,vars:28,consts:[[1,"left-box","fl"],["addGrpAuth","Flow.CreateGroup",3,"name","groupType","selectedGroup"],[1,"right-box","fr"],["rightBox",""],[1,"toolbar"],["resAuthx","",3,"behavior","rawData"],["sz-icon","","type","refresh",3,"nz-tooltip","click"],[1,"table-box"],["searchField","alias",3,"columns","data"],["table",""],["sz-column","nameColumn"],["processGroup",""],["nzTitle","\u65b0\u589e\u6d41\u7a0b",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"nzVisible","nzTitle","nzWidth","nzVisibleChange","nzOnCancel","nzOnOk"],["sz-icon","","type","xinzeng",3,"nz-tooltip","click"],["sz-icon","","type","daoru",3,"nz-tooltip","click"],["sz-icon","","type","daochu",3,"disabled","nz-tooltip","click"],["class","flow-name",3,"mouseenter","mouseleave",4,"ngIf","ngIfElse"],["inputTemplate",""],[1,"flow-name",3,"mouseenter","mouseleave"],["sz-icon","","type","xiugai",3,"fontsize","opacity","nz-tooltip","click"],["szAutofocus","","nz-input","","type","text",3,"ngModel","ngModelChange","click","keyup.enter","blur"],[3,"name","groupType","readonly","selectedGroup"],[2,"padding","15px","line-height","32px"],[4,"ngIf","ngIfElse"],["programTemplate",""],["nz-row",""],["nz-col","",1,"form-label",3,"nzSpan"],["nz-col","","nz-input","","type","text",1,"form-nz",3,"nzSpan","ngModel","ngModelChange"],["nz-row","",2,"margin-bottom","0"],["nz-col","","rows","4","nz-input","",3,"nzSpan","ngModel","ngModelChange"],["nz-col","","class","program-file-upload",3,"nzSpan",4,"ngIf","ngIfElse"],["fileTemplate",""],["nz-col","",1,"program-file-upload",3,"nzSpan"],["nzType","drag",3,"nzBeforeUpload"],["nz-col","",1,"program-file-box",3,"nzSpan"],["sz-icon","","type","shanchu",3,"click"],[2,"padding","15px"],["class","program-file-upload",4,"ngIf","ngIfElse"],["importFileTemplate",""],["nz-checkbox","",3,"ngModel","ngModelChange"],[1,"program-file-upload"],[1,"program-file-box"],[2,"width","100%",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-group-tree",1),t.NdJ("selectedGroup",function(a){return n.selectedGroupHandler(a)}),t.ALo(2,"nzI18n"),t.qZA()(),t.TgZ(3,"div",2,3)(5,"div",4)(6,"span"),t.YNc(7,E,2,3,"ng-template",5),t.YNc(8,S,2,3,"ng-template",5),t.YNc(9,B,2,4,"ng-template",5),t.TgZ(10,"i",6),t.NdJ("click",function(){return n.getGraphList(!0)}),t.ALo(11,"nzI18n"),t.qZA()()(),t.TgZ(12,"div",7)(13,"app-table",8,9),t.YNc(15,$,3,2,"ng-template",10),t.qZA()()(),t.YNc(16,U,2,5,"ng-template",null,11,t.W1O),t.TgZ(18,"nz-modal",12),t.NdJ("nzVisibleChange",function(a){return n.isVisible=a})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(19,q,5,2,"ng-container",13),t.qZA(),t.TgZ(20,"nz-modal",14),t.NdJ("nzVisibleChange",function(a){return n.importVisible=a})("nzOnCancel",function(){return n.importCancel()})("nzOnOk",function(){return n.importOk()}),t.ALo(21,"nzI18n"),t.YNc(22,nt,9,3,"ng-container",13),t.qZA(),t.TgZ(23,"nz-modal",14),t.NdJ("nzVisibleChange",function(a){return n.exportVisible=a})("nzOnCancel",function(){return n.exportCancel()})("nzOnOk",function(){return n.exportOk()}),t.ALo(24,"nzI18n"),t.ALo(25,"nzI18n"),t.YNc(26,it,4,2,"ng-container",13),t.qZA()),2&e&&(t.xp6(1),t.Q6J("name",t.lcZ(2,18,"base.processGroup"))("groupType",n.groupType),t.xp6(6),t.Q6J("behavior","flow.create")("rawData",n.selectedGroup),t.xp6(1),t.Q6J("behavior","flow.import")("rawData",n.selectedGroup),t.xp6(1),t.Q6J("behavior","flow.batchExport")("rawData",n.selectedGroup),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(11,20,"base.refresh")),t.xp6(3),t.Q6J("columns",n.columns)("data",n.listOfData),t.xp6(5),t.Q6J("nzVisible",n.isVisible),t.xp6(2),t.Q6J("nzVisible",n.importVisible)("nzTitle",t.lcZ(21,22,"base.import"))("nzWidth",450),t.xp6(3),t.Q6J("nzVisible",n.exportVisible)("nzTitle",t.lcZ(24,24,"base.pleaseSelect")+t.lcZ(25,26,"base.version"))("nzWidth",350))},directives:[I.u,L.Ud,D.D6,N.SY,v.a,V.Hh,P.O5,d.Zp,m.Fj,Q.T,m.JJ,m.On,C.du,C.Hf,b.SK,b.t3,H.FY,j.Ie,y.Vq,P.sg,y.Ip],pipes:[h.o9],styles:["html.default[_ngcontent-%COMP%]   html[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   body[_ngcontent-%COMP%]{min-width:1366px}html.default[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}html.default[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;flex:auto;flex-direction:column}html.default[_ngcontent-%COMP%]   .fdc[_ngcontent-%COMP%]{flex-direction:column}html.default[_ngcontent-%COMP%]   .fdr[_ngcontent-%COMP%]{flex-direction:row}html.default[_ngcontent-%COMP%]   .fauto[_ngcontent-%COMP%]{flex:auto}html.default[_ngcontent-%COMP%]   .pf[_ngcontent-%COMP%]{position:fixed}html.default[_ngcontent-%COMP%]   .pr[_ngcontent-%COMP%]{position:relative}html.default[_ngcontent-%COMP%]   .pa[_ngcontent-%COMP%]{position:absolute}html.default[_ngcontent-%COMP%]   .fl[_ngcontent-%COMP%]{float:left}html.default[_ngcontent-%COMP%]   .fr[_ngcontent-%COMP%]{float:right}html.default[_ngcontent-%COMP%]   .clear-f[_ngcontent-%COMP%]{clear:both}html.default[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-table-pagination.ant-pagination[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .ant-pagination[_ngcontent-%COMP%]{text-align:right}html.default[_ngcontent-%COMP%]   .ant-table-column-sorter[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger[_ngcontent-%COMP%]{color:#a1a1a1}html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger.active[_ngcontent-%COMP%]{color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-sort[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-has-sorters[_ngcontent-%COMP%]:hover{background:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-tree-switcher[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tree-indent-unit[_ngcontent-%COMP%]{width:17px;color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{padding:0}html.default[_ngcontent-%COMP%]   .ant-tree-checkbox-inner[_ngcontent-%COMP%]{display:inline-block}html.default[_ngcontent-%COMP%]   .ant-select-tree[_ngcontent-%COMP%]   .ant-select-tree-node-content-wrapper.ant-select-tree-node-selected[_ngcontent-%COMP%]:hover{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-modal-title[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-item-selected[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-submenu-title-selected[_ngcontent-%COMP%]{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]{background-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]:after{border-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tooltip[_ngcontent-%COMP%]{max-width:550px;max-height:550px;overflow:hidden}html.default[_ngcontent-%COMP%]   .ant-tooltip-content[_ngcontent-%COMP%]{width:100%;height:100%;max-width:550px;max-height:542px}html.default[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{box-shadow:none}html.default   [_nghost-%COMP%]   .left-box[_ngcontent-%COMP%]{width:300px;height:100%;border:1px solid #dbe9ea}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]{width:calc(100% - 315px);height:100%;margin-left:15px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   i.ic-niantie[_ngcontent-%COMP%]{font-size:16px;position:relative;top:-2px;margin-left:3px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-move{font-size:19px;position:relative;top:-1px;margin-left:2px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-fuzhi{font-size:24px;margin-right:0;position:relative;top:1px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-lishibanben{font-size:17px;position:relative;bottom:1px;margin:0 2px}html.default   [_nghost-%COMP%]   .flow-name[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%;justify-content:space-between}html.dark   [_nghost-%COMP%]   .left-box[_ngcontent-%COMP%]{width:300px;height:100%;border:1px solid #dbe9ea}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]{width:calc(100% - 315px);height:100%;margin-left:15px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   i.ic-niantie[_ngcontent-%COMP%]{font-size:16px;position:relative;top:-2px;margin-left:3px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-move{font-size:19px;position:relative;top:-1px;margin-left:2px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-fuzhi{font-size:24px;margin-right:0;position:relative;top:1px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-lishibanben{font-size:17px;position:relative;bottom:1px;margin:0 2px}html.dark   [_nghost-%COMP%]   .flow-name[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%;justify-content:space-between}"]}),i})();var at=o(4128),rt=o(82683),lt=o(92124),pt=o(51753);function ct(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"span",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().searchHandler()}),t.qZA()}}const mt=function(i){return{height:i}};let ht=(()=>{class i{constructor(e,n,s,a,p){this.api=e,this.router=n,this.message=s,this.i18n=a,this.service=p,this.typeList=[{name:"process.type",children:[{name:"PROGRAM",alias:"\u7a0b\u5e8f\u6d41\u7a0b",selected:!0},{name:"JOBCTRL",alias:"\u4f5c\u4e1a\u63a7\u5236\u6d41\u7a0b",selected:!0}]},{name:"process.computionFramework",children:null}],this.listOfData=[],this.pageInfo={pageIndex:1,pageSize:10,total:0},this.searchValue="",this.graphTypes="",this.computionFrameworks="",this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"name",render:"nameColumn"},{i18n:"process.type",field:"graphTypeZh"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"process.versionNum",field:"currentMementoVersion"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{buttons:[{icon:"sheji1",tip:"menu.design",click:c=>this.editGraph(c)},{icon:"lishibanben",tip:"process.historicalVersion",click:c=>this.goToMemento(c)},{icon:"job",tip:"menu.job",click:c=>this.goToJob(c)},{icon:"shanchu",tip:"base.delete",type:"delete",confirmTip:"menu.process",click:c=>this.deleteConfirm(c)}]}]}ngOnInit(){(0,at.D)([this.service.getProcessTypeList(),this.service.getComputionFrameworkList()]).subscribe(e=>{e[0].map(n=>{n.selected=!0,this.typeList[0].children.unshift(n)}),this.graphTypes=this.typeList[0].children.map(n=>n.name).join(","),this.typeList[1].children=e[1].map(n=>(n.selected=!0,n)),this.computionFrameworks=this.typeList[1].children.map(n=>n.name).join(","),this.getGraphList()})}selectGraphTypeHandler(e){this.graphTypes=e,this.getGraphList()}selectComputionFrameworkHandler(e){this.computionFrameworks=e,this.getGraphList()}searchHandler(){this.getGraphList()}getGraphList(){this.api.searchGraph(this.computionFrameworks,this.graphTypes,this.searchValue,this.pageInfo.pageIndex,this.pageInfo.pageSize).subscribe(e=>{this.listOfData=e.content,this.pageInfo.total=e.totalElements,this.listOfData.map(n=>{var s;n.graphTypeZh=null===(s=this.typeList[0].children.find(a=>a.name===n.graphType))||void 0===s?void 0:s.alias}),this.listOfData.map(n=>{var s;n.computionFrameworkZh=null===(s=this.typeList[1].children.find(a=>a.name===n.computionFramework))||void 0===s?void 0:s.alias}),this.listOfData.map(n=>{var s;n.versionTypeZh=null===(s=g.IA.find(a=>a.value===n.currentMementoVersionType))||void 0===s?void 0:s.label})})}pageChangeHandler(e){this.pageInfo.pageIndex=e.pageIndex,this.pageInfo.pageSize=e.pageSize,this.getGraphList()}editGraph(e){this.router.navigate(["PROGRAM"===e.graphType?`/process/program/edit/${e.id}`:`/process/edit/${e.id}`])}deleteConfirm(e){this.api.deleteGraph(e.id).subscribe(n=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.getGraphList()})}goTo(){this.router.navigate(["process"])}goToJob(e){this.router.navigate(["process/job/list"],{queryParams:{processId:e.id}})}goToMemento(e){this.router.navigate(["process/memento/list"],{queryParams:{processId:e.id}})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.DQ),t.Y36(u.F0),t.Y36(T.dD),t.Y36(h.wi),t.Y36(z.q))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-process-retrieval"]],decls:23,vars:23,consts:[[1,"page-retrieval","pr"],["nzSearch","","nzSize","large",3,"nzSuffix"],["type","text","nz-input","",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["suffixIconSearch",""],[1,"types-box"],["typesBox",""],[1,"type-box"],[1,"type-label"],[1,"type-item-box"],[3,"data","selected"],[1,"table-box",3,"ngStyle"],[3,"columns","data","total","pageIndex","pageSize","pageChange"],["nz-icon","","nzType","search",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"nz-input-group",1)(2,"input",2),t.NdJ("ngModelChange",function(a){return n.searchValue=a})("keyup.enter",function(){return n.searchHandler()}),t.ALo(3,"nzI18n"),t.ALo(4,"nzI18n"),t.qZA()(),t.YNc(5,ct,1,0,"ng-template",null,3,t.W1O),t.TgZ(7,"div",4,5)(9,"div",6)(10,"span",7),t._uU(11),t.ALo(12,"nzI18n"),t.qZA(),t.TgZ(13,"span",8)(14,"sz-checkbox-btn",9),t.NdJ("selected",function(a){return n.selectGraphTypeHandler(a)}),t.qZA()()(),t.TgZ(15,"div",6)(16,"span",7),t._uU(17),t.ALo(18,"nzI18n"),t.qZA(),t.TgZ(19,"span",8)(20,"sz-checkbox-btn",9),t.NdJ("selected",function(a){return n.selectComputionFrameworkHandler(a)}),t.qZA()()()(),t.TgZ(21,"div",10)(22,"app-table",11),t.NdJ("pageChange",function(a){return n.pageChangeHandler(a)}),t.qZA()()()),2&e){const s=t.MAs(6),a=t.MAs(8);t.xp6(1),t.Q6J("nzSuffix",s),t.xp6(1),t.Q6J("ngModel",n.searchValue)("placeholder",t.lcZ(3,13,"base.pleaseInput")+t.lcZ(4,15,"process.name")),t.xp6(9),t.hij("",t.lcZ(12,17,n.typeList[0].name),": "),t.xp6(3),t.Q6J("data",n.typeList[0].children),t.xp6(3),t.hij("",t.lcZ(18,19,n.typeList[1].name),": "),t.xp6(3),t.Q6J("data",n.typeList[1].children),t.xp6(1),t.Q6J("ngStyle",t.VKq(21,mt,"calc(100% - 111px - "+a.offsetHeight+"px)")),t.xp6(1),t.Q6J("columns",n.columns)("data",n.listOfData)("total",n.pageInfo.total)("pageIndex",n.pageInfo.pageIndex)("pageSize",n.pageInfo.pageSize)}},directives:[rt.w,d.gB,d.ke,d.Zp,m.Fj,m.JJ,m.On,lt.Ls,pt.R,P.PC,v.a],pipes:[h.o9],encapsulation:2}),i})();const gt=["groupPanel"],dt=[{path:"",component:(()=>{class i{constructor(){}ngOnInit(){}_onReuseInit(e){this.groupPanel.getGraphList()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-process-main"]],viewQuery:function(e,n){if(1&e&&t.Gf(gt,5),2&e){let s;t.iGM(s=t.CRH())&&(n.groupPanel=s.first)}},decls:10,vars:6,consts:[[3,"alias"],[1,"tab-content",2,"padding","15px"],["groupPanel",""],[1,"tab-content"]],template:function(e,n){1&e&&(t.TgZ(0,"sz-tabs")(1,"sz-tab",0),t.ALo(2,"nzI18n"),t.TgZ(3,"div",1),t._UZ(4,"app-process-group",null,2),t.qZA()(),t.TgZ(6,"sz-tab",0),t.ALo(7,"nzI18n"),t.TgZ(8,"div",3),t._UZ(9,"app-process-retrieval"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("alias",t.lcZ(2,2,"menu.process")),t.xp6(5),t.Q6J("alias",t.lcZ(7,4,"base.retrieval")))},directives:[F.z,Z.y,st,ht],pipes:[h.o9],styles:[".tab-content[_ngcontent-%COMP%]{width:100%;height:calc(100% - 25px)}"]}),i})(),data:{reuse:!0}},{path:"edit/:id",loadChildren:()=>Promise.all([o.e(635),o.e(254),o.e(795),o.e(575),o.e(249),o.e(754),o.e(592),o.e(453)]).then(o.bind(o,78453)).then(i=>i.DefinitionModule),data:{preload:!0}},{path:"program/edit/:id",loadChildren:()=>Promise.all([o.e(635),o.e(254),o.e(795),o.e(575),o.e(249),o.e(947),o.e(592),o.e(725)]).then(o.bind(o,11725)).then(i=>i.DefinitionProgramModule)},{path:"debug/:id",loadChildren:()=>Promise.all([o.e(635),o.e(254),o.e(795),o.e(575),o.e(249),o.e(57),o.e(592),o.e(923)]).then(o.bind(o,24923)).then(i=>i.DebugModule)},{path:"job/list",loadChildren:()=>Promise.all([o.e(795),o.e(241),o.e(947),o.e(592),o.e(546)]).then(o.bind(o,47298)).then(i=>i.JobListModule),data:{reuse:!0}},{path:"job/add",loadChildren:()=>Promise.all([o.e(635),o.e(795),o.e(241),o.e(947),o.e(92),o.e(592),o.e(931)]).then(o.bind(o,12296)).then(i=>i.JobFormModule)},{path:"job/edit/:jobId",loadChildren:()=>Promise.all([o.e(635),o.e(795),o.e(241),o.e(947),o.e(92),o.e(592),o.e(931)]).then(o.bind(o,12296)).then(i=>i.JobFormModule)},{path:"program/job/list",loadChildren:()=>Promise.all([o.e(795),o.e(241),o.e(947),o.e(592),o.e(546)]).then(o.bind(o,47298)).then(i=>i.JobListModule),data:{reuse:!0}},{path:"program/job/add",loadChildren:()=>Promise.all([o.e(635),o.e(795),o.e(241),o.e(947),o.e(92),o.e(592),o.e(931)]).then(o.bind(o,12296)).then(i=>i.JobFormModule)},{path:"program/job/edit/:jobId",loadChildren:()=>Promise.all([o.e(635),o.e(795),o.e(241),o.e(947),o.e(92),o.e(592),o.e(931)]).then(o.bind(o,12296)).then(i=>i.JobFormModule)},{path:"memento/list",loadChildren:()=>Promise.all([o.e(635),o.e(254),o.e(575),o.e(754)]).then(o.bind(o,9754)).then(i=>i.MementoListBoxModule)}];let ut=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[G.m,u.Bz.forChild(dt)]]}),i})()}}]);