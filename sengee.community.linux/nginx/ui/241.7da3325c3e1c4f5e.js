"use strict";(self.webpackChunksengee_ui=self.webpackChunksengee_ui||[]).push([[241],{42241:($,k,a)=>{a.d(k,{Q:()=>V});var n=a(28076),C=a(46055),M=a(34654),t=a(5e3),L=a(50489),x=a(49727),b=a(89445),O=a(77152),h=a(24091),T=a(41123),z=a(69808),E=a(5156),y=a(404),w=a(13287),v=a(62545),Z=a(76083),B=a(18393),U=a(72394),F=a(55535),N=a(6462),A=a(93075),p=a(49841),u=a(93486);const o=["taskList"],r=["schedulerTable"];function c(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"i",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().goBack()}),t.ALo(1,"nzI18n"),t.qZA()}2&l&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.return"))}function d(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"i",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("immediate")}),t.ALo(1,"nzI18n"),t.qZA()}2&l&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function f(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"i",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(11).batchDelete()}),t.ALo(1,"nzI18n"),t.qZA()}if(2&l){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!(null!=e.table&&e.table.checked||null!=e.table&&e.table.indeterminate))("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function R(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"sz-tab",5),t.ALo(1,"nzI18n"),t.TgZ(2,"div",6)(3,"div",7)(4,"span"),t.YNc(5,d,2,3,"ng-template",8),t.YNc(6,f,2,4,"ng-template",8),t.TgZ(7,"i",9),t.NdJ("click",function(){return t.CHM(e),t.MAs(11).refresh(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",10)(10,"app-task-list",11,12),t.NdJ("lookLog",function(s){return t.CHM(e),t.oxw().currentTask=s}),t.qZA()()()()}if(2&l){const e=t.oxw();t.Q6J("alias",t.lcZ(1,11,"job.immediate")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,13,"base.refresh")),t.xp6(3),t.Q6J("groupId",e.groupId)("processId",e.processId)}}function J(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"i",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("scheduler")}),t.ALo(1,"nzI18n"),t.qZA()}2&l&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function I(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"i",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).batchDelete("scheduler")}),t.ALo(1,"nzI18n"),t.qZA()}if(2&l){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!e.checked&&!e.indeterminate)("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function D(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"i",19),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw(2).currentJob=_}),t.qZA(),t.TgZ(1,"i",20),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw(2).editJob("scheduler",_)}),t.ALo(2,"nzI18n"),t.qZA(),t.TgZ(3,"i",21),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw(2).runJob(_)}),t.qZA(),t.TgZ(4,"i")(5,"nz-switch",22),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw(2).enableJob(_)}),t.qZA()(),t.TgZ(6,"i",23),t.NdJ("nzOnConfirm",function(){const _=t.CHM(e).$implicit;return t.oxw(2).deleteConfirm(_,"scheduler")}),t.ALo(7,"nzI18n"),t.ALo(8,"nzI18n"),t.ALo(9,"nzI18n"),t.qZA()}if(2&l){const e=g.$implicit;t.Q6J("nz-tooltip","\u67e5\u770b\u4efb\u52a1\u5217\u8868"),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(2,8,"base.edit")),t.xp6(2),t.Q6J("disabled",!e.enabled)("nz-tooltip","\u7acb\u5373\u6267\u884c"),t.xp6(2),t.Q6J("ngModel",e.enabled)("nzControl",!0),t.xp6(1),t.Q6J("nzPopconfirmTitle",t.lcZ(7,10,"base.confirmDel")+t.lcZ(8,12,"menu.job")+"?")("nz-tooltip",t.lcZ(9,14,"base.delete"))}}function W(l,g){if(1&l&&(t.TgZ(0,"a",24),t._uU(1),t.qZA()),2&l){const e=g.$implicit;t.Q6J("href",e.trackUrl,t.LSH),t.xp6(1),t.Oqu(e.trackUrl)}}function K(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"sz-tab",5),t.ALo(1,"nzI18n"),t.TgZ(2,"div",6)(3,"div",7)(4,"span"),t.YNc(5,J,2,3,"ng-template",8),t.YNc(6,I,2,4,"ng-template",8),t.TgZ(7,"i",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().schedulerJobList(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",10)(10,"app-table",15,16),t.NdJ("pageChange",function(s){return t.CHM(e),t.oxw().pageChangeHandler(s,"scheduler")}),t.YNc(12,D,10,16,"ng-template",17),t.YNc(13,W,2,2,"ng-template",18),t.qZA()()()()}if(2&l){const e=t.oxw();t.Q6J("alias",t.lcZ(1,14,"job.scheduler")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,16,"base.refresh")),t.xp6(3),t.Q6J("columns",e.columns)("data",e.schedulerJobListData)("total",e.schedulerPage.total)("pageIndex",e.schedulerPage.pageIndex)("pageSize",e.schedulerPage.pageSize)}}const S=function(l){return{padding:l}};function Y(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26),t._uU(2),t.TgZ(3,"span")(4,"i",27),t.NdJ("click",function(){return t.CHM(e),t.MAs(9).batchDelete()}),t.ALo(5,"nzI18n"),t.qZA(),t.TgZ(6,"i",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().currentJob=null}),t.qZA()()(),t.TgZ(7,"div",29)(8,"app-task-list",30,31),t.NdJ("lookLog",function(s){return t.CHM(e),t.oxw().currentTask=s}),t.qZA()()()}if(2&l){const e=t.MAs(9),i=t.oxw();t.xp6(2),t.hij(" \u4f5c\u4e1a\u540d\u79f0: ",null==i.currentJob?null:i.currentJob.name," "),t.xp6(2),t.Q6J("fontsize",24)("disabled",!(null!=e.table&&e.table.checked||null!=e.table&&e.table.indeterminate))("nz-tooltip",t.lcZ(5,6,"BatchDelete.title")),t.xp6(3),t.Q6J("ngStyle",t.VKq(8,S,i.processId?"15px":"15px 0 0")),t.xp6(1),t.Q6J("jobId",null==i.currentJob?null:i.currentJob.id)}}function G(l,g){if(1&l){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26),t._uU(2," \u4efb\u52a1\u65e5\u5fd7 "),t.TgZ(3,"i",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().currentTask=null}),t.qZA()(),t.TgZ(4,"div",29),t._UZ(5,"app-task-log",32),t.qZA()()}if(2&l){const e=t.oxw();t.xp6(4),t.Q6J("ngStyle",t.VKq(2,S,e.processId?"15px":"15px 0 0")),t.xp6(1),t.Q6J("taskId",null==e.currentTask?null:e.currentTask.id)}}let V=(()=>{class l{constructor(e,i,s,_,m,P){this.api=e,this.message=i,this.i18n=s,this.router=_,this.deleteSer=m,this.service=P,this.columns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(Q,j)=>Q.some(H=>-1!==j.priority.indexOf(H))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn"}],this.eventColumns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(Q,j)=>Q.some(H=>-1!==j.priority.indexOf(H))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl1"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn1"}],this.contentStyle={height:"calc(100% - 32px)"},this.schedulerPage={pageIndex:1,pageSize:10,total:0},this.eventPage={pageIndex:1,pageSize:10,total:0}}ngOnInit(){this.processId&&(this.contentStyle={height:"calc(100% - 25px)",padding:"0 15px 15px"}),this.columns[3].listOfFilter=M.Y.map(e=>({text:e.label,value:e.value})),this.eventColumns[3].listOfFilter=M.Y.map(e=>({text:e.label,value:e.value})),this.service.getComputionFrameworkList().subscribe(e=>{this.computionFrameworkData=e,this.mappingAlias(this.schedulerJobListData),this.mappingAlias(this.eventJobListData)})}ngOnChanges(e){this.schedulerJobList(),this.eventJobList()}schedulerJobList(e=!1){this.processId?this.api.getJobList(this.processId,"SCHEDULER",this.schedulerPage.pageIndex,this.schedulerPage.pageSize).subscribe(i=>{this.schedulerJobListData=i.content,this.mappingAlias(this.schedulerJobListData),this.schedulerPage.total=i.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"SCHEDULER",this.schedulerPage.pageIndex,this.schedulerPage.pageSize).subscribe(i=>{this.schedulerJobListData=i.content,this.mappingAlias(this.schedulerJobListData),this.schedulerPage.total=i.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.schedulerJobListData=null,this.schedulerPage.total=0)}eventJobList(e=!1){this.processId?this.api.getJobList(this.processId,"EVENT",this.eventPage.pageIndex,this.eventPage.pageSize).subscribe(i=>{this.eventJobListData=i.content,this.mappingAlias(this.eventJobListData),this.eventPage.total=i.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"EVENT",this.eventPage.pageIndex,this.eventPage.pageSize).subscribe(i=>{this.eventJobListData=i.content,this.mappingAlias(this.eventJobListData),this.eventPage.total=i.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.eventJobListData=null,this.eventPage.total=0)}mappingAlias(e){!e||!this.computionFrameworkData||e.map(i=>{var s,_,m;i.priorityZh=null===(s=M.Y.find(P=>P.value===i.priority))||void 0===s?void 0:s.label,i.processVersionTypeZh=null===(_=C.IA.find(P=>P.value===i.processVersionType))||void 0===_?void 0:_.label,i.computionFrameworkZh=null===(m=this.computionFrameworkData.find(P=>P.name===i.computionFramework))||void 0===m?void 0:m.alias})}pageChangeHandler(e,i){this[`${i}Page`].pageIndex=e.pageIndex,this[`${i}Page`].pageSize=e.pageSize,this[`${i}JobList`]()}enableJob(e){this.api.enableJob(e.id,!e.enabled).subscribe(i=>{e.enabled=!e.enabled})}runJob(e){!e.enabled||this.api.runJob(e.id).subscribe(i=>{this.message.success("\u6267\u884c\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!")})}stopJob(e){!e.enabled||this.api.stopJob(e.id).subscribe(i=>{this.message.success("\u505c\u6b62\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!")})}deleteConfirm(e,i){this.api.deleteJob(e.id).subscribe(s=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this[`${i}JobList`]()})}batchDelete(e){this.deleteSer.open().then(()=>{this.api.deleteJob(this.schedulerJobListData.filter(i=>i.selected).map(i=>i.id).join(",")).subscribe(i=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.schedulerTable.checked=this.schedulerTable.indeterminate=!1,this[`${e}JobList`]()})})}goBack(){this.router.navigate(["/process"])}addJob(e){let i="";const s={type:e};this.groupId?(s.groupId=this.groupId,i="/job/add"):this.processId&&(s.processId=this.processId,i=this.isProgram?"/process/program/job/add":"/process/job/add"),this.router.navigate([i],{queryParams:s})}editJob(e,i){let s="";const _={type:e};this.groupId?(_.groupId=this.groupId,s="/job/edit/"):this.processId&&(_.processId=this.processId,s=this.isProgram?"/process/program/job/edit/":"/process/job/edit/"),this.router.navigate([`${s}${i.id}`],{queryParams:_})}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(L.k5),t.Y36(x.dD),t.Y36(b.wi),t.Y36(O.F0),t.Y36(h.s7),t.Y36(T.q))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-job-list"]],viewQuery:function(e,i){if(1&e&&(t.Gf(o,5),t.Gf(r,5)),2&e){let s;t.iGM(s=t.CRH())&&(i.taskList=s.first),t.iGM(s=t.CRH())&&(i.schedulerTable=s.first)}},inputs:{processId:"processId",isProgram:"isProgram",groupId:"groupId",selectedGroup:"selectedGroup"},features:[t.TTD],decls:7,vars:5,consts:[[1,"layout","pr"],["sz-icon","","type","return","class","pa",3,"nz-tooltip","click",4,"ngIf"],[3,"alias",4,"authx"],["class","modal pa",4,"ngIf"],["sz-icon","","type","return",1,"pa",3,"nz-tooltip","click"],[3,"alias"],[1,"tab-content","pr",3,"ngStyle"],[1,"toolbar"],["resAuthx","",3,"behavior","rawData","irrelevantRawData"],["sz-icon","","type","refresh",3,"nz-tooltip","click"],[1,"job-box"],[3,"groupId","processId","lookLog"],["taskList",""],["sz-icon","","type","xinzeng",3,"nz-tooltip","click"],["sz-icon","","type","piliangshanchu",3,"disabled","nz-tooltip","click"],["searchField","name",3,"columns","data","total","pageIndex","pageSize","pageChange"],["schedulerTable",""],["sz-column","optColumn"],["sz-column","trackUrl"],["sz-icon","","type","eye",3,"nz-tooltip","click"],["sz-icon","","type","xiugai",3,"nz-tooltip","click"],["sz-icon","","type","yunhang",3,"disabled","nz-tooltip","click"],["nzSize","small","nzCheckedChildren","\u7981\u7528","nzUnCheckedChildren","\u542f\u7528",3,"ngModel","nzControl","click"],["sz-icon","","type","shanchu","nz-popconfirm","",3,"nzPopconfirmTitle","nz-tooltip","nzOnConfirm"],["target","_blank",3,"href"],[1,"modal","pa"],[1,"bread-crumb"],["sz-icon","","type","piliangshanchu",3,"fontsize","disabled","nz-tooltip","click"],["sz-icon","","type","return",3,"click"],[1,"modal-inner",3,"ngStyle"],[3,"jobId","lookLog"],["taskList1",""],[3,"taskId"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,c,2,3,"i",1),t.TgZ(2,"sz-tabs"),t.YNc(3,R,12,15,"sz-tab",2),t.YNc(4,K,14,18,"sz-tab",2),t.qZA(),t.YNc(5,Y,10,10,"div",3),t.YNc(6,G,6,4,"div",3),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",i.processId),t.xp6(2),t.Q6J("authx","Job.List.Immediate"),t.xp6(1),t.Q6J("authx","Job.List.Scheduler"),t.xp6(1),t.Q6J("ngIf",i.currentJob),t.xp6(1),t.Q6J("ngIf",i.currentTask))},directives:[z.O5,E.D6,y.SY,w.z,v.xo,Z.y,z.PC,v.Ud,B.n,U.a,F.Hh,N.i,A.JJ,A.On,p.JW,u.t],pipes:[b.o9],styles:["html.default[_ngcontent-%COMP%]   html[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   body[_ngcontent-%COMP%]{min-width:1366px}html.default[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}html.default[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;flex:auto;flex-direction:column}html.default[_ngcontent-%COMP%]   .fdc[_ngcontent-%COMP%]{flex-direction:column}html.default[_ngcontent-%COMP%]   .fdr[_ngcontent-%COMP%]{flex-direction:row}html.default[_ngcontent-%COMP%]   .fauto[_ngcontent-%COMP%]{flex:auto}html.default[_ngcontent-%COMP%]   .pf[_ngcontent-%COMP%]{position:fixed}html.default[_ngcontent-%COMP%]   .pr[_ngcontent-%COMP%]{position:relative}html.default[_ngcontent-%COMP%]   .pa[_ngcontent-%COMP%]{position:absolute}html.default[_ngcontent-%COMP%]   .fl[_ngcontent-%COMP%]{float:left}html.default[_ngcontent-%COMP%]   .fr[_ngcontent-%COMP%]{float:right}html.default[_ngcontent-%COMP%]   .clear-f[_ngcontent-%COMP%]{clear:both}html.default[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-table-pagination.ant-pagination[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .ant-pagination[_ngcontent-%COMP%]{text-align:right}html.default[_ngcontent-%COMP%]   .ant-table-column-sorter[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger[_ngcontent-%COMP%]{color:#a1a1a1}html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger.active[_ngcontent-%COMP%]{color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-sort[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-has-sorters[_ngcontent-%COMP%]:hover{background:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-tree-switcher[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tree-indent-unit[_ngcontent-%COMP%]{width:17px;color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{padding:0}html.default[_ngcontent-%COMP%]   .ant-tree-checkbox-inner[_ngcontent-%COMP%]{display:inline-block}html.default[_ngcontent-%COMP%]   .ant-select-tree[_ngcontent-%COMP%]   .ant-select-tree-node-content-wrapper.ant-select-tree-node-selected[_ngcontent-%COMP%]:hover{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-modal-title[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-item-selected[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-submenu-title-selected[_ngcontent-%COMP%]{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]{background-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]:after{border-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tooltip[_ngcontent-%COMP%]{max-width:550px;max-height:550px;overflow:hidden}html.default[_ngcontent-%COMP%]   .ant-tooltip-content[_ngcontent-%COMP%]{width:100%;height:100%;max-width:550px;max-height:542px}html.default[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{box-shadow:none}html.default   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.default   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.default   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.default   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.default   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.default   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.default   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.default   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.4;cursor:not-allowed}html.default   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.default   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.default   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.default   [_nghost-%COMP%]     .app-table .ant-table-pagination.ant-pagination{margin-top:8px}html.default   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fbffff;z-index:2}html.default   [_nghost-%COMP%]   .modal-inner[_ngcontent-%COMP%]{width:100%;height:calc(100% - 25px);overflow-y:auto}html.dark   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.dark   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.dark   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.dark   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.dark   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.4;cursor:not-allowed}html.dark   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.dark   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.dark   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.dark   [_nghost-%COMP%]     .app-table .ant-table-pagination.ant-pagination{margin-top:8px}html.dark   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fbfcff;z-index:2}html.dark   [_nghost-%COMP%]   .modal-inner[_ngcontent-%COMP%]{width:100%;height:calc(100% - 25px);overflow-y:auto}"],data:{animation:[n.MC]}}),l})()},18393:($,k,a)=>{a.d(k,{n:()=>A});var n=a(5e3),C=a(46055),M=a(50489),t=a(77152),L=a(49727),x=a(89445),b=a(24091),O=a(41123),h=a(72394),T=a(55535),z=a(69808),E=a(5156),y=a(404),w=a(49841);const v=["table"];function Z(p,u){if(1&p&&(n.TgZ(0,"a",4),n._uU(1),n.qZA()),2&p){const o=u.$implicit;n.Q6J("href",o.trackUrl,n.LSH),n.xp6(1),n.Oqu(o.trackUrl)}}function B(p,u){if(1&p){const o=n.EpF();n.ynx(0),n.TgZ(1,"i",7),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit;return n.oxw().lookDebugDataHandler(c)}),n.qZA(),n.BQk()}2&p&&(n.xp6(1),n.Q6J("fontsize",16)("nz-tooltip","\u67e5\u770b\u6570\u636e"))}function U(p,u){if(1&p){const o=n.EpF();n.TgZ(0,"i",14),n.NdJ("click",function(){n.CHM(o);const c=n.oxw(2).$implicit;return n.oxw().lookDataHandler(c,"task")}),n.qZA()}2&p&&n.Q6J("nz-tooltip","\u67e5\u770b\u5173\u8054\u5b50\u4efb\u52a1")("fontsize",18)}function F(p,u){if(1&p){const o=n.EpF();n.TgZ(0,"i",8),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit;return n.oxw().lookLogHandler(c)}),n.qZA(),n.TgZ(1,"i",9),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit;return n.oxw().lookDataHandler(c)}),n.qZA(),n.YNc(2,U,1,2,"i",10),n.TgZ(3,"i",11),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit;return n.oxw().lookDataHandler(c,"result")}),n.qZA(),n.TgZ(4,"i",12),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit;return n.oxw().stopHandler(c)}),n.qZA(),n.TgZ(5,"i",13),n.NdJ("nzOnConfirm",function(){n.CHM(o);const c=n.oxw().$implicit;return n.oxw().deleteConfirm(c)}),n.ALo(6,"nzI18n"),n.ALo(7,"nzI18n"),n.ALo(8,"nzI18n"),n.qZA()}if(2&p){const o=n.oxw().$implicit;n.Q6J("nz-tooltip","\u67e5\u770b\u65e5\u5fd7"),n.xp6(1),n.Q6J("nz-tooltip","\u67e5\u770b\u72b6\u6001"),n.xp6(1),n.Q6J("ngIf","JOBCTRL"===o.graphType),n.xp6(1),n.Q6J("disabled","FINISHED"!==o.state)("nz-tooltip","\u67e5\u770b\u6570\u636e"),n.xp6(1),n.Q6J("disabled","RUNNING"!==o.state&&"QUEUING"!==o.state)("nz-tooltip","\u7ed3\u675f")("fontsize",17),n.xp6(1),n.Q6J("nzPopconfirmTitle",n.lcZ(6,10,"base.confirmDel")+n.lcZ(7,12,"menu.job")+"?")("nz-tooltip",n.lcZ(8,14,"base.delete"))}}function N(p,u){if(1&p&&(n.YNc(0,B,2,2,"ng-container",5),n.YNc(1,F,9,16,"ng-template",null,6,n.W1O)),2&p){const o=n.MAs(2),r=n.oxw();n.Q6J("ngIf",r.taskList)("ngIfElse",o)}}let A=(()=>{class p{constructor(o,r,c,d,f,R){this.api=o,this.router=r,this.message=c,this.i18n=d,this.deleteSer=f,this.service=R,this.lookLog=new n.vpe,this.lookDebugData=new n.vpe,this.page={pageIndex:1,pageSize:10,total:0},this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"process.versionType",field:"processVersionTypeZh",filterMultiple:!0,listOfFilter:[],filterFn:(J,I)=>J.some(D=>-1!==I.processVersionType.indexOf(D))},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"base.startTime",field:"runStartTime"},{i18n:"base.endTime",field:"runEndTime"},{i18n:"job.consuming",field:"duration"},{i18n:"base.status",field:"stateZh",filterMultiple:!0,listOfFilter:[],filterFn:(J,I)=>J.some(D=>-1!==I.state.indexOf(D))},{i18n:"job.taskUrl",render:"trackUrl"},{type:"operate",render:"opts"}]}ngOnInit(){this.columns[3].listOfFilter=C.IA.map(o=>({text:o.label,value:o.value})),this.columns[8].listOfFilter=C.hY.map(o=>({text:o.label,value:o.value})),this.service.getComputionFrameworkList().subscribe(o=>{this.computionFrameworkData=o,this.mappingAlias()})}ngOnChanges(o){this.refresh()}refresh(o=!1){this.jobId?this.getTaskListByJobId(o):this.groupId?this.getTaskListByGroupId(o):this.processId?this.getTaskListByProcessId(o):this.taskList?(this.columns.splice(2,1,{i18n:"\u4f5c\u4e1a\u540d\u79f0",field:"jobName"}),this.data=this.taskList,this.mappingAlias(),this.page.total=0):(this.data=null,this.page.total=0)}getTaskListByJobId(o=!1){this.api.getJobTaskListByJob(this.jobId,this.page.pageIndex,this.page.pageSize).subscribe(r=>{this.data=r.content,this.mappingAlias(),this.page.total=r.totalElements,o&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}getTaskListByGroupId(o=!1){this.api.getJobTaskListByGroup(this.groupId,"IMMEDIATE",this.page.pageIndex,this.page.pageSize).subscribe(r=>{this.data=r.content,this.mappingAlias(),this.page.total=r.totalElements,o&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}getTaskListByProcessId(o=!1){this.api.getJobTaskList(this.processId,"IMMEDIATE",this.page.pageIndex,this.page.pageSize).subscribe(r=>{this.data=r.content,this.mappingAlias(),this.page.total=r.totalElements,o&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}mappingAlias(){!this.data||!this.computionFrameworkData||this.data.map(o=>{var r,c,d;o.stateZh=null===(r=C.hY.find(f=>f.value===o.state))||void 0===r?void 0:r.label,o.processVersionTypeZh=null===(c=C.IA.find(f=>f.value===o.processVersionType))||void 0===c?void 0:c.label,o.computionFrameworkZh=null===(d=this.computionFrameworkData.find(f=>f.name===o.computionFramework))||void 0===d?void 0:d.alias})}pageChangeHandler(o){this.page.pageIndex=o.pageIndex,this.page.pageSize=o.pageSize,this.refresh()}deleteConfirm(o){this.api.deleteJobTask(o.id).subscribe(r=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.refresh()})}batchDelete(){this.deleteSer.open().then(()=>{this.api.deleteJobTask(this.data.filter(o=>o.selected).map(o=>o.id).join(",")).subscribe(o=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.table.checked=this.table.indeterminate=!1,this.refresh()})})}stopHandler(o){this.api.stopTask(o.id).subscribe(r=>{this.refresh()})}lookLogHandler(o){this.lookLog.emit(o)}lookDebugDataHandler(o){this.lookDebugData.emit(o)}lookDataHandler(o,r="status"){this.router.navigate([`/job/result/${o.id}`],{queryParams:{processId:o.processId,type:r}})}}return p.\u0275fac=function(o){return new(o||p)(n.Y36(M.k5),n.Y36(t.F0),n.Y36(L.dD),n.Y36(x.wi),n.Y36(b.s7),n.Y36(O.q))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-task-list"]],viewQuery:function(o,r){if(1&o&&n.Gf(v,5),2&o){let c;n.iGM(c=n.CRH())&&(r.table=c.first)}},inputs:{taskList:"taskList",jobId:"jobId",groupId:"groupId",processId:"processId"},outputs:{lookLog:"lookLog",lookDebugData:"lookDebugData"},features:[n.TTD],decls:4,vars:5,consts:[["searchField","processName",3,"columns","data","total","pageIndex","pageSize","pageChange"],["table",""],["sz-column","trackUrl"],["sz-column","opts"],["target","_blank",3,"href"],[4,"ngIf","ngIfElse"],["optsTemp",""],["sz-icon","","type","chakanshuju1",3,"fontsize","nz-tooltip","click"],["sz-icon","","type","chakanrizhi1",3,"nz-tooltip","click"],["sz-icon","","type","chakanzhuangtai1",3,"nz-tooltip","click"],["sz-icon","","type","renwuguanli",3,"nz-tooltip","fontsize","click",4,"ngIf"],["sz-icon","","type","chakanshuju1",3,"disabled","nz-tooltip","click"],["sz-icon","","type","stop",3,"disabled","nz-tooltip","fontsize","click"],["sz-icon","","type","shanchu","nz-popconfirm","",3,"nzPopconfirmTitle","nz-tooltip","nzOnConfirm"],["sz-icon","","type","renwuguanli",3,"nz-tooltip","fontsize","click"]],template:function(o,r){1&o&&(n.TgZ(0,"app-table",0,1),n.NdJ("pageChange",function(d){return r.pageChangeHandler(d)}),n.YNc(2,Z,2,2,"ng-template",2),n.YNc(3,N,3,2,"ng-template",3),n.qZA()),2&o&&n.Q6J("columns",r.columns)("data",r.data)("total",r.page.total)("pageIndex",r.page.pageIndex)("pageSize",r.page.pageSize)},directives:[h.a,T.Hh,z.O5,E.D6,y.SY,w.JW],pipes:[x.o9],encapsulation:2}),p})()},93486:($,k,a)=>{a.d(k,{t:()=>x});var n=a(5e3),C=a(50489),M=a(44987),t=a(93075);const L=function(){return{mode:"text/plain",readOnly:!0}};let x=(()=>{class b{constructor(h){this.api=h,this.text=""}ngOnInit(){this.api.getJobTaskLog(this.taskId).subscribe(h=>{this.text=h})}}return b.\u0275fac=function(h){return new(h||b)(n.Y36(C.k5))},b.\u0275cmp=n.Xpm({type:b,selectors:[["app-task-log"]],inputs:{taskId:"taskId"},decls:1,vars:3,consts:[[3,"ngModel","options","ngModelChange"]],template:function(h,T){1&h&&(n.TgZ(0,"dy-codemirror",0),n.NdJ("ngModelChange",function(E){return T.text=E}),n.qZA()),2&h&&n.Q6J("ngModel",T.text)("options",n.DdM(2,L))},directives:[M.vf,t.JJ,t.On],encapsulation:2}),b})()}}]);