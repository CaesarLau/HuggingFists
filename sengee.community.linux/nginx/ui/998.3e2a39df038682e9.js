"use strict";(self.webpackChunksengee_ui=self.webpackChunksengee_ui||[]).push([[998],{5998:(Pt,_,i)=>{i.r(_),i.d(_,{MainModule:()=>ft});var g=i(7152),m=i(2545),P=i(4219),A=i(2886),t=i(5e3),z=i(2683),d=i(9445);function J(o,r){1&o&&(t.TgZ(0,"li",6),t._uU(1),t.ALo(2,"nzI18n"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"menu.process")," "))}function I(o,r){1&o&&(t.TgZ(0,"li",7),t._uU(1),t.ALo(2,"nzI18n"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"base.retrieval")," "))}let L=(()=>{class o{constructor(e,n){this.route=e,this.helper=n}ngOnInit(){this.helper.defaultEnter(this.route),this.subscription=this.helper.simulateReuse(this.route)}ngOnDestroy(){this.subscription.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(g.gz),t.Y36(m.$J))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-process-main"]],decls:7,vars:2,consts:[[1,"tab-menu-box"],[1,"menu"],["nz-menu",""],["nz-menu-item","","nzMatchRouter","","routerLink","./list",4,"authx"],["nz-menu-item","","nzMatchRouter","","routerLink","./retrieval",4,"authx"],[1,"content",2,"padding","15px"],["nz-menu-item","","nzMatchRouter","","routerLink","./list"],["nz-menu-item","","nzMatchRouter","","routerLink","./retrieval"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"ul",2),t.YNc(3,J,3,3,"li",3),t.YNc(4,I,3,3,"li",4),t.qZA()(),t.TgZ(5,"div",5),t._UZ(6,"dy-router-outlet"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("authx","Process.List"),t.xp6(1),t.Q6J("authx","Process.Retrieval"))},directives:[P.wO,m.xo,z.w,P.r9,g.rH,m.Fr],pipes:[d.o9],encapsulation:2}),o})();var N=i(7781),f=i(6055),Q=i(6817),x=i(489),v=i(9727),u=i(1453),y=i(1123),D=i(5882),V=i(404),b=i(2394),H=i(5535),M=i(9808),C=i(1047),h=i(3075),G=i(3640),F=i(1894),Z=i(8054),w=i(5052),B=i(6114);const E=["processGroup"];function S(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"i",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().createFlow()}),t.ALo(1,"nzI18n"),t.qZA()}2&o&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function Y(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().importGraph()}),t.ALo(1,"nzI18n"),t.qZA()}2&o&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.import"))}function $(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().batchExportGraph()}),t.ALo(1,"nzI18n"),t.qZA()}if(2&o){t.oxw();const e=t.MAs(14);t.Q6J("disabled",!e.indeterminate&&!e.checked)("nz-tooltip",t.lcZ(1,2,"base.export"))}}function j(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",20),t.NdJ("mouseenter",function(){return t.CHM(e),t.oxw().$implicit.editingVisible=!0})("mouseleave",function(){return t.CHM(e),t.oxw().$implicit.editingVisible=!1}),t._uU(1),t.TgZ(2,"i",21),t.NdJ("click",function(a){t.CHM(e);const s=t.oxw().$implicit;return t.oxw().startEditName(a,s)}),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.alias," "),t.xp6(1),t.Q6J("fontsize",22)("opacity",e.editingVisible?1:.5)("nz-tooltip","\u4fee\u6539\u540d\u79f0")}}function R(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"input",22),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().$implicit.alias=a})("click",function(a){return a.stopPropagation()})("keyup.enter",function(){t.CHM(e);const a=t.oxw().$implicit;return t.oxw().saveGraphName(a)})("blur",function(){t.CHM(e);const a=t.oxw().$implicit;return t.oxw().saveGraphName(a)}),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.Q6J("ngModel",e.alias)}}function k(o,r){if(1&o&&(t.YNc(0,j,3,4,"div",18),t.YNc(1,R,1,1,"ng-template",null,19,t.W1O)),2&o){const e=r.$implicit,n=t.MAs(2);t.Q6J("ngIf",!e.editing)("ngIfElse",n)}}function U(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"app-group-tree",23),t.NdJ("selectedGroup",function(a){return t.CHM(e),t.oxw().selectedTargetGroupHandler(a)}),t.ALo(1,"nzI18n"),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("name",t.lcZ(1,3,"PrcGrp"))("groupType",e.groupType)("readonly",!0)}}function W(o,r){if(1&o&&t._UZ(0,"nz-option",31),2&o){const e=r.$implicit;t.Q6J("nzLabel",e.alias)("nzValue",e.id)}}function X(o,r){if(1&o&&t._UZ(0,"nz-option",31),2&o){const e=r.$implicit;t.Q6J("nzLabel",e.alias)("nzValue",e.id)}}function K(o,r){if(1&o&&t._UZ(0,"nz-option",31),2&o){const e=r.$implicit;t.Q6J("nzLabel",e.alias)("nzValue",e.name)}}function q(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"p",25)(2,"span",26),t._uU(3,"\u4e1a\u52a1\u7c7b\u578b\uff1a"),t.qZA(),t.TgZ(4,"nz-select",27),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw(3).formParams.graphType=a}),t.YNc(5,X,1,2,"nz-option",28),t.qZA()(),t.TgZ(6,"p",25)(7,"span",26),t._uU(8,"\u8ba1\u7b97\u6846\u67b6\uff1a"),t.qZA(),t.TgZ(9,"nz-select",27),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw(3).formParams.computionFramework=a}),t.YNc(10,K,1,2,"nz-option",28),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw(3);t.xp6(2),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",e.formParams.graphType),t.xp6(1),t.Q6J("ngForOf",e.graphTypeData),t.xp6(2),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",e.formParams.computionFramework),t.xp6(1),t.Q6J("ngForOf",e.computionFrameworkData)}}function tt(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"p",25)(2,"span",26),t._uU(3,"\u6d41\u7a0b\u540d\u79f0\uff1a"),t.qZA(),t.TgZ(4,"input",32),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw(2).formParams.alias=a}),t.qZA()(),t.YNc(5,q,11,8,"ng-container",33),t.TgZ(6,"p",34)(7,"span",26),t._uU(8,"\u63cf\u8ff0\u4fe1\u606f\uff1a"),t.qZA(),t.TgZ(9,"textarea",35),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw(2).formParams.jsonProperties=a}),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",e.formParams.alias),t.xp6(1),t.Q6J("ngIf","GRAPH"===e.formParams.processType),t.xp6(2),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",e.formParams.jsonProperties)}}function et(o,r){if(1&o&&(t.TgZ(0,"span",38)(1,"nz-upload",39)(2,"p"),t._uU(3,"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20"),t.qZA()()()),2&o){const e=t.oxw(3);t.Q6J("nzSpan",19),t.xp6(1),t.Q6J("nzBeforeUpload",e.beforeUpload)}}function nt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"span",40),t._uU(1),t.TgZ(2,"i",41),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).removeProgramFile()}),t.qZA()()}if(2&o){const e=t.oxw(3);t.Q6J("nzSpan",19),t.xp6(1),t.hij(" ",e.programFile.name," ")}}function ot(o,r){if(1&o&&(t.TgZ(0,"p",34)(1,"span",26),t._uU(2,"\u7a0b\u5e8f\u5305\uff1a"),t.qZA(),t.YNc(3,et,4,2,"span",36),t.YNc(4,nt,3,2,"ng-template",null,37,t.W1O),t.qZA()),2&o){const e=t.MAs(5),n=t.oxw(2);t.xp6(1),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("ngIf",!n.programFile)("ngIfElse",e)}}function it(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",24)(2,"p",25)(3,"span",26),t._uU(4,"\u6d41\u7a0b\u7c7b\u578b\uff1a"),t.qZA(),t.TgZ(5,"nz-select",27),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().formParams.processType=a}),t.YNc(6,W,1,2,"nz-option",28),t.qZA()(),t.YNc(7,tt,10,7,"ng-container",29),t.YNc(8,ot,6,3,"ng-template",null,30,t.W1O),t.qZA(),t.BQk()}if(2&o){const e=t.MAs(9),n=t.oxw();t.xp6(3),t.Q6J("nzSpan",5),t.xp6(2),t.Q6J("nzSpan",19)("ngModel",n.formParams.processType),t.xp6(1),t.Q6J("ngForOf",n.processTypeData),t.xp6(1),t.Q6J("ngIf","GRAPH"===n.formParams.processType||"JOB"===n.formParams.processType)("ngIfElse",e)}}function at(o,r){if(1&o&&(t.TgZ(0,"span",46)(1,"nz-upload",39)(2,"p"),t._uU(3,"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20"),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("nzBeforeUpload",e.beforeImport)}}function st(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"span",47),t._uU(1),t.TgZ(2,"i",41),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).removeImportFile()}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.importFile.name," ")}}function rt(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",42)(2,"p"),t.YNc(3,at,4,1,"span",43),t.YNc(4,st,3,1,"ng-template",null,44,t.W1O),t.qZA(),t.TgZ(6,"p")(7,"label",45),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().overwrite=a}),t._uU(8,"\u662f\u5426\u66f4\u65b0\u540c\u540d\u6d41\u7a0b"),t.qZA()()(),t.BQk()}if(2&o){const e=t.MAs(5),n=t.oxw();t.xp6(3),t.Q6J("ngIf",!n.importFile)("ngIfElse",e),t.xp6(4),t.Q6J("ngModel",n.overwrite)}}function lt(o,r){if(1&o&&t._UZ(0,"nz-option",31),2&o){const e=r.$implicit;t.Q6J("nzLabel",e.version+"("+e.versionTypeZh+")")("nzValue",e.id)}}function pt(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",42)(2,"nz-select",48),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().selectedMementoId=a}),t.YNc(3,lt,1,2,"nz-option",28),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngModel",e.selectedMementoId),t.xp6(1),t.Q6J("ngForOf",e.mementoList)}}let ct=(()=>{class o{constructor(e,n,a,s,p,c,Ct){this.api=e,this.operatorApi=n,this.router=a,this.message=s,this.i18n=p,this.ser=c,this.service=Ct,this.groupType=f.b0.PrcGrp,this.typeData=[{id:"PROGRAM",alias:"\u7a0b\u5e8f\u6d41\u7a0b"},{id:"JOB",alias:"\u4f5c\u4e1a\u63a7\u5236\u6d41\u7a0b"}],this.processTypeData=[{id:"GRAPH",alias:"\u6267\u884c\u56fe\u6d41\u7a0b"},...this.typeData],this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"name",render:"nameColumn"},{i18n:"process.type",field:"graphTypeZh",filterMultiple:!0,listOfFilter:[],filterFn:(l,O)=>l.some(T=>-1!==O.graphType.indexOf(T))},{i18n:"process.computionFramework",field:"computionFrameworkZh",filterMultiple:!0,listOfFilter:[],filterFn:(l,O)=>l.some(T=>-1!==O.computionFramework.indexOf(T))},{i18n:"process.versionNum",field:"currentMementoVersion"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{buttons:[{icon:"sheji1",tip:"menu.design",click:l=>this.editGraph(l)},{icon:"move",tip:"base.move",click:l=>this.moveGraph(l)},{icon:"fuzhi",tip:"base.copy",click:l=>this.copyGraph(l)},{icon:"daochu",tip:"base.export",click:l=>this.getMementoList(l)},{icon:"lishibanben",tip:"process.historicalVersion",click:l=>this.goToMemento(l)},{icon:"job",tip:"menu.job",click:l=>this.goToJob(l)},{icon:"shanchu",tip:"base.delete",type:"delete",confirmTip:"menu.process",click:l=>this.deleteConfirm(l)}]}],this.isVisible=!1,this.formParams={alias:"",processType:"GRAPH",graphType:"",computionFramework:"",_processType:"GRAPH",_graphType:"",_computionFramework:"",jsonProperties:""},this.beforeUpload=l=>"application/zip"!==l.type&&"application/x-zip-compressed"!==l.type?(this.message.error("\u53ea\u80fd\u4e0a\u4f20zip\u5305!"),!1):(this.programFile=l,!1),this.importVisible=!1,this.overwrite=!0,this.exportVisible=!1,this.beforeImport=l=>l.name&&-1!==l.name.indexOf(".flow")?(this.importFile=l,!1):(this.message.error("\u53ea\u80fd\u4e0a\u4f20\u5bfc\u51fa\u7684\u6d41\u7a0b\u5305!"),!1)}ngOnInit(){this.service.getProcessTypeList().subscribe(e=>{this.graphTypeData=e,this.formParams.graphType=this.formParams._graphType=e[0].id,this.mappingGraphTypeAndComputionFramework(),this.columns[3].listOfFilter=[...e,...this.typeData].map(n=>({text:n.alias,value:n.id}))}),this.service.getComputionFrameworkList().subscribe(e=>{this.computionFrameworkData=e,this.formParams.computionFramework=this.formParams._computionFramework=e[0].name,this.mappingGraphTypeAndComputionFramework(),this.columns[4].listOfFilter=e.map(n=>({text:n.alias,value:n.name}))})}selectedGroupHandler(e){this.selectedGroup=e,this.getGraphList()}getGraphList(e=!1){this.selectedGroup?this.api.getGraphList(this.selectedGroup.id,"").subscribe(n=>{this.listOfData=n,this.listOfData.map(a=>{var s;a.versionTypeZh=null===(s=f.IA.find(p=>p.value===a.currentMementoVersionType))||void 0===s?void 0:s.label}),this.mappingGraphTypeAndComputionFramework(),e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.listOfData=null}ngAfterViewInit(){}deleteConfirm(e){this.api.deleteGraph(e.id).subscribe(n=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.getGraphList()})}mappingGraphTypeAndComputionFramework(){!this.listOfData||!this.listOfData.length||(this.graphTypeData&&this.listOfData.map(e=>{var n;e.graphTypeZh="PROGRAM"!==e.graphType?null===(n=this.graphTypeData.find(a=>a.id===e.graphType))||void 0===n?void 0:n.alias:"\u7a0b\u5e8f\u6d41\u7a0b"}),this.computionFrameworkData&&this.listOfData.map(e=>{var n;e.computionFrameworkZh=null===(n=this.computionFrameworkData.find(a=>a.name===e.computionFramework))||void 0===n?void 0:n.alias}))}removeProgramFile(){this.programFile=null}createFlow(){this.formParams.alias=`\u9ed8\u8ba4\u540d\u79f0_${(new Date).getHours()}${(new Date).getMinutes()}${(new Date).getSeconds()}`,this.isVisible=!0}handleOk(){"PROGRAM"===this.formParams.processType?this.addProgramGraph():this.addGraph()}handleCancel(){this.formParams.name=this.formParams.alias=this.formParams.jsonProperties="",this.formParams.processType=this.formParams._processType,this.formParams.graphType=this.formParams._graphType,this.formParams.computionFramework=this.formParams._computionFramework,this.programFile=null,this.isVisible=!1}addProgramGraph(){this.api.createProgram(this.programFile,this.selectedGroup.id).subscribe(e=>{this.handleCancel(),setTimeout(()=>{this.editGraph(e.body)})})}addGraph(){this.formParams.alias?(this.formParams.groupId=this.selectedGroup.id,"JOB"===this.formParams.processType&&(this.formParams.computionFramework="oyez",this.formParams.graphType="JOBCTRL"),this.operatorApi.getContainerOperator(this.formParams.computionFramework,this.formParams.graphType).subscribe(e=>{let n,a;try{n=JSON.parse(e.inputPorts)}catch(c){n=e.inputPorts}try{a=JSON.parse(e.outputPorts)}catch(c){a=e.outputPorts}const s=(new Q.j).initWithJsonData(Object.assign(Object.assign({},e),{inport:n,outport:a})),p=(0,N.d9)(this.formParams);delete p.processType,delete p._processType,delete p._graphType,delete p._computionFramework,p.graphXml=s.graphXml,this.api.addGraph(p,this.selectedGroup.id).subscribe(c=>{this.handleCancel(),setTimeout(()=>{this.editGraph(c)})})})):this.message.warning(`${this.i18n.translate("base.pleaseInput")}${this.i18n.translate("base.name").toLocaleLowerCase()}`)}editGraph(e){this.router.navigate(["PROGRAM"===e.graphType?`/process/program/edit/${e.id}`:`/process/edit/${e.id}`])}moveGraph(e){this.ser.show({title:"\u9009\u62e9\u5206\u7ec4",content:this.processGroup,backdropClass:"opacity-mask",top:69,right:225,confirm:()=>new Promise((n,a)=>{this.api.moveGraph(e.id,this.selectedTargetGrp.id).subscribe(s=>{this.message.success("\u79fb\u52a8\u6210\u529f!"),n(!0),this.getGraphList()},s=>{a(!1)})})})}copyGraph(e){this.ser.show({title:"\u9009\u62e9\u5206\u7ec4\u7c98\u8d34",content:this.processGroup,backdropClass:"opacity-mask",top:69,right:225,confirm:()=>new Promise((n,a)=>{this.api.copyGraph(e.id,this.selectedTargetGrp.id).subscribe(s=>{this.message.success("\u7c98\u8d34\u6210\u529f!"),n(!0),this.getGraphList()},s=>{a(!1)})})})}selectedTargetGroupHandler(e){this.selectedTargetGrp=e}importGraph(){this.importVisible=!0}importCancel(){this.importVisible=!1}importOk(){this.api.importGraph(this.importFile,this.selectedGroup.id,this.overwrite).subscribe(e=>{this.message.success("\u5bfc\u5165\u6210\u529f!"),this.importVisible=!1,this.getGraphList()})}removeImportFile(){this.importFile=null}getMementoList(e){this.api.getMementoList(e.id,"").subscribe(n=>{this.mementoList=n,this.mementoList.map(a=>{var s;a.versionTypeZh=null===(s=f.IA.find(p=>p.value===a.versionType))||void 0===s?void 0:s.label}),this.selectedMementoId=this.mementoList[0].id,this.exportVisible=!0})}exportOk(){this.exportVisible=!1,window.open(this.api.exportGraphByMementoId(this.selectedMementoId))}exportCancel(){this.exportVisible=!1}batchExportGraph(){window.open(this.api.exportGraph(this.listOfData.filter(e=>e.selected).map(e=>e.id)))}goToJob(e){this.router.navigate(["process/job/list"],{queryParams:{processId:e.id}})}goToMemento(e){this.router.navigate(["process/memento/list"],{queryParams:{processId:e.id}})}startEditName(e,n){e.stopPropagation(),n.editing=!0,this.editItem=n,this.editItem._alias=n.alias}saveGraphName(e){if(e.alias)return e.alias===e._alias?(delete e._alias,e.editing=!1,e.editingVisible=!1,void(this.editItem=null)):(clearTimeout(this.saveGraphNameTimer),void(this.saveGraphNameTimer=setTimeout(()=>{this.api.renameGraph(e.id,e.alias).subscribe(n=>{e.editing=!1,e.editingVisible=!1,this.editItem=null,this.message.success(`${this.i18n.translate("base.update")}${this.i18n.translate("base.success")}`)})},100)));this.message.warning(`${this.i18n.translate("base.pleaseInput")}${this.i18n.translate("base.name")}`)}documentClickHandler(e){this.editItem&&this.saveGraphName(this.editItem)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.DQ),t.Y36(x.gl),t.Y36(g.F0),t.Y36(v.dD),t.Y36(d.wi),t.Y36(u.M_),t.Y36(y.q))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-process-group"]],viewQuery:function(e,n){if(1&e&&t.Gf(E,5),2&e){let a;t.iGM(a=t.CRH())&&(n.processGroup=a.first)}},hostBindings:function(e,n){1&e&&t.NdJ("click",function(s){return n.documentClickHandler(s)},!1,t.evT)},decls:27,vars:28,consts:[[1,"left-box","fl"],["addGrpAuth","Flow.CreateGroup",3,"name","groupType","selectedGroup"],[1,"right-box","fr"],["rightBox",""],[1,"toolbar"],["resAuthx","",3,"behavior","rawData"],["dy-icon","","type","refresh",3,"nz-tooltip","click"],[1,"table-box"],["searchField","alias",3,"columns","data"],["table",""],["dy-column","nameColumn"],["processGroup",""],["nzTitle","\u65b0\u589e\u6d41\u7a0b",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"nzVisible","nzTitle","nzWidth","nzVisibleChange","nzOnCancel","nzOnOk"],["dy-icon","","type","xinzeng",3,"nz-tooltip","click"],["dy-icon","","type","daoru",3,"nz-tooltip","click"],["dy-icon","","type","daochu",3,"disabled","nz-tooltip","click"],["class","flow-name",3,"mouseenter","mouseleave",4,"ngIf","ngIfElse"],["inputTemplate",""],[1,"flow-name",3,"mouseenter","mouseleave"],["dy-icon","","type","xiugai",3,"fontsize","opacity","nz-tooltip","click"],["dyAutofocus","","nz-input","","type","text",3,"ngModel","ngModelChange","click","keyup.enter","blur"],[3,"name","groupType","readonly","selectedGroup"],[2,"padding","15px","line-height","32px"],["nz-row",""],["nz-col","",1,"form-label",3,"nzSpan"],["nz-col","",1,"form-nz",3,"nzSpan","ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["programTemplate",""],[3,"nzLabel","nzValue"],["nz-col","","nz-input","","type","text",1,"form-nz",3,"nzSpan","ngModel","ngModelChange"],[4,"ngIf"],["nz-row","",2,"margin-bottom","0"],["nz-col","","rows","4","nz-input","",3,"nzSpan","ngModel","ngModelChange"],["nz-col","","class","program-file-upload",3,"nzSpan",4,"ngIf","ngIfElse"],["fileTemplate",""],["nz-col","",1,"program-file-upload",3,"nzSpan"],["nzType","drag",3,"nzBeforeUpload"],["nz-col","",1,"program-file-box",3,"nzSpan"],["dy-icon","","type","shanchu",3,"click"],[2,"padding","15px"],["class","program-file-upload",4,"ngIf","ngIfElse"],["importFileTemplate",""],["nz-checkbox","",3,"ngModel","ngModelChange"],[1,"program-file-upload"],[1,"program-file-box"],[2,"width","100%",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-group-tree",1),t.NdJ("selectedGroup",function(s){return n.selectedGroupHandler(s)}),t.ALo(2,"nzI18n"),t.qZA()(),t.TgZ(3,"div",2,3)(5,"div",4)(6,"span"),t.YNc(7,S,2,3,"ng-template",5),t.YNc(8,Y,2,3,"ng-template",5),t.YNc(9,$,2,4,"ng-template",5),t.TgZ(10,"i",6),t.NdJ("click",function(){return n.getGraphList(!0)}),t.ALo(11,"nzI18n"),t.qZA()()(),t.TgZ(12,"div",7)(13,"app-table",8,9),t.YNc(15,k,3,2,"ng-template",10),t.qZA()()(),t.YNc(16,U,2,5,"ng-template",null,11,t.W1O),t.TgZ(18,"nz-modal",12),t.NdJ("nzVisibleChange",function(s){return n.isVisible=s})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(19,it,10,6,"ng-container",13),t.qZA(),t.TgZ(20,"nz-modal",14),t.NdJ("nzVisibleChange",function(s){return n.importVisible=s})("nzOnCancel",function(){return n.importCancel()})("nzOnOk",function(){return n.importOk()}),t.ALo(21,"nzI18n"),t.YNc(22,rt,9,3,"ng-container",13),t.qZA(),t.TgZ(23,"nz-modal",14),t.NdJ("nzVisibleChange",function(s){return n.exportVisible=s})("nzOnCancel",function(){return n.exportCancel()})("nzOnOk",function(){return n.exportOk()}),t.ALo(24,"nzI18n"),t.ALo(25,"nzI18n"),t.YNc(26,pt,4,2,"ng-container",13),t.qZA()),2&e&&(t.xp6(1),t.Q6J("name",t.lcZ(2,18,"PrcGrp"))("groupType",n.groupType),t.xp6(6),t.Q6J("behavior","flow.create")("rawData",n.selectedGroup),t.xp6(1),t.Q6J("behavior","flow.import")("rawData",n.selectedGroup),t.xp6(1),t.Q6J("behavior","flow.batchExport")("rawData",n.selectedGroup),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(11,20,"base.refresh")),t.xp6(3),t.Q6J("columns",n.columns)("data",n.listOfData),t.xp6(5),t.Q6J("nzVisible",n.isVisible),t.xp6(2),t.Q6J("nzVisible",n.importVisible)("nzTitle",t.lcZ(21,22,"base.import"))("nzWidth",450),t.xp6(3),t.Q6J("nzVisible",n.exportVisible)("nzTitle",t.lcZ(24,24,"base.pleaseSelect")+t.lcZ(25,26,"base.version"))("nzWidth",350))},directives:[D.u,m.Ud,u.kE,V.SY,b.a,H.rA,M.O5,C.Zp,h.Fj,u.pQ,h.JJ,h.On,G.du,G.Hf,F.SK,F.t3,Z.Vq,M.sg,Z.Ip,w.FY,B.Ie],pipes:[d.o9],styles:["html.default[_ngcontent-%COMP%]   html[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   body[_ngcontent-%COMP%]{min-width:1366px}html.default[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}html.default[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;flex:auto;flex-direction:column}html.default[_ngcontent-%COMP%]   .fdc[_ngcontent-%COMP%]{flex-direction:column}html.default[_ngcontent-%COMP%]   .fdr[_ngcontent-%COMP%]{flex-direction:row}html.default[_ngcontent-%COMP%]   .fauto[_ngcontent-%COMP%]{flex:auto}html.default[_ngcontent-%COMP%]   .pf[_ngcontent-%COMP%]{position:fixed}html.default[_ngcontent-%COMP%]   .pr[_ngcontent-%COMP%]{position:relative}html.default[_ngcontent-%COMP%]   .pa[_ngcontent-%COMP%]{position:absolute}html.default[_ngcontent-%COMP%]   .fl[_ngcontent-%COMP%]{float:left}html.default[_ngcontent-%COMP%]   .fr[_ngcontent-%COMP%]{float:right}html.default[_ngcontent-%COMP%]   .clear-f[_ngcontent-%COMP%]{clear:both}html.default[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-table-pagination.ant-pagination[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .ant-pagination[_ngcontent-%COMP%]{text-align:right}html.default[_ngcontent-%COMP%]   .ant-table-column-sorter[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger[_ngcontent-%COMP%]{color:#a1a1a1}html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger.active[_ngcontent-%COMP%]{color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-sort[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-has-sorters[_ngcontent-%COMP%]:hover{background:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-tree-switcher[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tree-indent-unit[_ngcontent-%COMP%]{width:17px;color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{padding:0}html.default[_ngcontent-%COMP%]   .ant-tree-checkbox-inner[_ngcontent-%COMP%]{display:inline-block}html.default[_ngcontent-%COMP%]   .ant-select-tree[_ngcontent-%COMP%]   .ant-select-tree-node-content-wrapper.ant-select-tree-node-selected[_ngcontent-%COMP%]:hover{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-modal-title[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-item-selected[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-submenu-title-selected[_ngcontent-%COMP%]{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]{background-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]:after{border-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tooltip[_ngcontent-%COMP%]{max-width:550px;max-height:550px;overflow:hidden}html.default[_ngcontent-%COMP%]   .ant-tooltip-content[_ngcontent-%COMP%]{width:100%;height:100%;max-width:550px;max-height:542px}html.default[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{box-shadow:none}html.default   [_nghost-%COMP%]   .left-box[_ngcontent-%COMP%]{width:300px;height:100%;border:1px solid #dbe9ea}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]{width:calc(100% - 315px);height:100%;margin-left:15px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   i.ic-niantie[_ngcontent-%COMP%]{font-size:16px;position:relative;top:-2px;margin-left:3px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-move{font-size:19px;position:relative;top:-1px;margin-left:2px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-fuzhi{font-size:24px;margin-right:0;position:relative;top:1px}html.default   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-lishibanben{font-size:17px;position:relative;bottom:1px;margin:0 2px}html.default   [_nghost-%COMP%]   .flow-name[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%;justify-content:space-between}html.dark   [_nghost-%COMP%]   .left-box[_ngcontent-%COMP%]{width:300px;height:100%;border:1px solid #dbe9ea}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]{width:calc(100% - 315px);height:100%;margin-left:15px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   i.ic-niantie[_ngcontent-%COMP%]{font-size:16px;position:relative;top:-2px;margin-left:3px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-move{font-size:19px;position:relative;top:-1px;margin-left:2px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-fuzhi{font-size:24px;margin-right:0;position:relative;top:1px}html.dark   [_nghost-%COMP%]   .right-box[_ngcontent-%COMP%]   .table-box[_ngcontent-%COMP%]     i.ic-lishibanben{font-size:17px;position:relative;bottom:1px;margin:0 2px}html.dark   [_nghost-%COMP%]   .flow-name[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%;justify-content:space-between}"]}),o})();var mt=i(4128);function ht(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"span",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().searchHandler()}),t.qZA()}}const gt=function(o){return{height:o}},ut=[{path:"",component:L,canActivate:[m.$P],canActivateChild:[m.$P],children:[{path:"list",component:ct,data:{authPathMatch:"full",reuse:!0},canActivate:[m.$P],canActivateChild:[m.$P]},{path:"retrieval",component:(()=>{class o{constructor(e,n,a,s,p){this.api=e,this.router=n,this.message=a,this.i18n=s,this.service=p,this.typeList=[{name:"process.type",children:[{value:"PROGRAM",alias:"\u7a0b\u5e8f\u6d41\u7a0b",selected:!0},{value:"JOBCTRL",alias:"\u4f5c\u4e1a\u63a7\u5236\u6d41\u7a0b",selected:!0}]},{name:"process.computionFramework",children:null}],this.listOfData=[],this.pageInfo={pageIndex:1,pageSize:10,total:0},this.searchValue="",this.graphTypes="",this.computionFrameworks="",this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"name",render:"nameColumn"},{i18n:"process.type",field:"graphTypeZh"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"process.versionNum",field:"currentMementoVersion"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{buttons:[{icon:"sheji1",tip:"menu.design",click:c=>this.editGraph(c)},{icon:"lishibanben",tip:"process.historicalVersion",click:c=>this.goToMemento(c)},{icon:"job",tip:"menu.job",click:c=>this.goToJob(c)},{icon:"shanchu",tip:"base.delete",type:"delete",confirmTip:"menu.process",click:c=>this.deleteConfirm(c)}]}]}ngOnInit(){(0,mt.D)([this.service.getProcessTypeList(),this.service.getComputionFrameworkList()]).subscribe(e=>{e[0].map(n=>{n.selected=!0,n.value=n.name,this.typeList[0].children.unshift(n)}),this.graphTypes=this.typeList[0].children.map(n=>n.value).join(","),this.typeList[1].children=e[1].map(n=>(n.selected=!0,n.value=n.name,n)),this.computionFrameworks=this.typeList[1].children.map(n=>n.value).join(","),this.getGraphList()})}selectGraphTypeHandler(e){this.graphTypes=e,this.getGraphList()}selectComputionFrameworkHandler(e){this.computionFrameworks=e,this.getGraphList()}searchHandler(){this.getGraphList()}getGraphList(){this.api.searchGraph(this.computionFrameworks,this.graphTypes,this.searchValue,this.pageInfo.pageIndex,this.pageInfo.pageSize).subscribe(e=>{this.listOfData=e.content,this.pageInfo.total=e.totalElements,this.listOfData.map(n=>{var a;n.graphTypeZh=null===(a=this.typeList[0].children.find(s=>s.value===n.graphType))||void 0===a?void 0:a.alias}),this.listOfData.map(n=>{var a;n.computionFrameworkZh=null===(a=this.typeList[1].children.find(s=>s.value===n.computionFramework))||void 0===a?void 0:a.alias}),this.listOfData.map(n=>{var a;n.versionTypeZh=null===(a=f.IA.find(s=>s.value===n.currentMementoVersionType))||void 0===a?void 0:a.label})})}pageChangeHandler(e){this.pageInfo.pageIndex=e.pageIndex,this.pageInfo.pageSize=e.pageSize,this.getGraphList()}editGraph(e){this.router.navigate(["PROGRAM"===e.graphType?`/process/program/edit/${e.id}`:`/process/edit/${e.id}`])}deleteConfirm(e){this.api.deleteGraph(e.id).subscribe(n=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.getGraphList()})}goTo(){this.router.navigate(["process"])}goToJob(e){this.router.navigate(["process/job/list"],{queryParams:{processId:e.id}})}goToMemento(e){this.router.navigate(["process/memento/list"],{queryParams:{processId:e.id}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.DQ),t.Y36(g.F0),t.Y36(v.dD),t.Y36(d.wi),t.Y36(y.q))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-process-retrieval"]],decls:23,vars:23,consts:[[1,"page-retrieval","pr"],["nzSearch","","nzSize","large",3,"nzSuffix"],["type","text","nz-input","",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["suffixIconSearch",""],[1,"types-box"],["typesBox",""],[1,"type-box"],[1,"type-label"],[1,"type-item-box"],[3,"data","selected"],[1,"table-box",3,"ngStyle"],[3,"columns","data","total","pageIndex","pageSize","pageChange"],["dy-icon","","type","sousuo",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"nz-input-group",1)(2,"input",2),t.NdJ("ngModelChange",function(s){return n.searchValue=s})("keyup.enter",function(){return n.searchHandler()}),t.ALo(3,"nzI18n"),t.ALo(4,"nzI18n"),t.qZA()(),t.YNc(5,ht,1,0,"ng-template",null,3,t.W1O),t.TgZ(7,"div",4,5)(9,"div",6)(10,"span",7),t._uU(11),t.ALo(12,"nzI18n"),t.qZA(),t.TgZ(13,"span",8)(14,"dy-checkbox-btn",9),t.NdJ("selected",function(s){return n.selectGraphTypeHandler(s)}),t.qZA()()(),t.TgZ(15,"div",6)(16,"span",7),t._uU(17),t.ALo(18,"nzI18n"),t.qZA(),t.TgZ(19,"span",8)(20,"dy-checkbox-btn",9),t.NdJ("selected",function(s){return n.selectComputionFrameworkHandler(s)}),t.qZA()()()(),t.TgZ(21,"div",10)(22,"app-table",11),t.NdJ("pageChange",function(s){return n.pageChangeHandler(s)}),t.qZA()()()),2&e){const a=t.MAs(6),s=t.MAs(8);t.xp6(1),t.Q6J("nzSuffix",a),t.xp6(1),t.Q6J("ngModel",n.searchValue)("placeholder",t.lcZ(3,13,"base.pleaseInput")+t.lcZ(4,15,"process.name")),t.xp6(9),t.hij("",t.lcZ(12,17,n.typeList[0].name),": "),t.xp6(3),t.Q6J("data",n.typeList[0].children),t.xp6(3),t.hij("",t.lcZ(18,19,n.typeList[1].name),": "),t.xp6(3),t.Q6J("data",n.typeList[1].children),t.xp6(1),t.Q6J("ngStyle",t.VKq(21,gt,"calc(100% - 111px - "+s.offsetHeight+"px)")),t.xp6(1),t.Q6J("columns",n.columns)("data",n.listOfData)("total",n.pageInfo.total)("pageIndex",n.pageInfo.pageIndex)("pageSize",n.pageInfo.pageSize)}},directives:[z.w,C.gB,C.ke,C.Zp,h.Fj,h.JJ,h.On,u.kE,u.Ov,M.PC,b.a],pipes:[d.o9],encapsulation:2}),o})(),data:{authPathMatch:"full"},canActivate:[m.$P],canActivateChild:[m.$P]}]},{path:"edit/:id",loadChildren:()=>Promise.all([i.e(351),i.e(254),i.e(795),i.e(575),i.e(249),i.e(754),i.e(592),i.e(453)]).then(i.bind(i,8453)).then(o=>o.DefinitionModule),data:{preload:!0}},{path:"program/edit/:id",loadChildren:()=>Promise.all([i.e(351),i.e(254),i.e(795),i.e(575),i.e(249),i.e(947),i.e(592),i.e(725)]).then(i.bind(i,1725)).then(o=>o.DefinitionProgramModule)},{path:"debug/:id",loadChildren:()=>Promise.all([i.e(351),i.e(254),i.e(795),i.e(575),i.e(249),i.e(57),i.e(592),i.e(923)]).then(i.bind(i,4923)).then(o=>o.DebugModule)},{path:"job/list",loadChildren:()=>Promise.all([i.e(795),i.e(241),i.e(947),i.e(592),i.e(298)]).then(i.bind(i,7298)).then(o=>o.JobListModule),data:{reuse:!0}},{path:"job/add",loadChildren:()=>Promise.all([i.e(351),i.e(795),i.e(241),i.e(947),i.e(327),i.e(592),i.e(296)]).then(i.bind(i,2296)).then(o=>o.JobFormModule)},{path:"job/edit/:jobId",loadChildren:()=>Promise.all([i.e(351),i.e(795),i.e(241),i.e(947),i.e(327),i.e(592),i.e(296)]).then(i.bind(i,2296)).then(o=>o.JobFormModule)},{path:"program/job/list",loadChildren:()=>Promise.all([i.e(795),i.e(241),i.e(947),i.e(592),i.e(298)]).then(i.bind(i,7298)).then(o=>o.JobListModule),data:{reuse:!0}},{path:"program/job/add",loadChildren:()=>Promise.all([i.e(351),i.e(795),i.e(241),i.e(947),i.e(327),i.e(592),i.e(296)]).then(i.bind(i,2296)).then(o=>o.JobFormModule)},{path:"program/job/edit/:jobId",loadChildren:()=>Promise.all([i.e(351),i.e(795),i.e(241),i.e(947),i.e(327),i.e(592),i.e(296)]).then(i.bind(i,2296)).then(o=>o.JobFormModule)},{path:"memento/list",loadChildren:()=>Promise.all([i.e(351),i.e(254),i.e(575),i.e(754)]).then(i.bind(i,9754)).then(o=>o.MementoListBoxModule)}];let ft=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[A.m,P.ip,m.OX,g.Bz.forChild(ut)]]}),o})()}}]);